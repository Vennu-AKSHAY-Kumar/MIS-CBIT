"use strict";(self.webpackChunkcbit_management_information_system=self.webpackChunkcbit_management_information_system||[]).push([[4538,6261],{6261:function(e,t,a){a.r(t);var r=a(7313),n=a(5662),o=a(2548),i=a(1405),s=a(501),l=a(1629),c=a(6835),d=a(3477),p=a(3467),h=a(4076),u=a(7478),x=a(7649),m=a(8737),g=a(5508),y=(a(8695),a(6417));t.default=()=>{const[e,t]=(0,r.useState)([]),[a,b]=(0,r.useState)(""),[f,j]=(0,r.useState)([]),[Z,v]=(0,r.useState)(""),[k,w]=(0,r.useState)([]),[$,C]=(0,r.useState)(""),[P,S]=(0,r.useState)([]),[_,E]=r.useState(0),[R,F]=r.useState(10),[T,L]=(0,r.useState)(null),[D,V]=(0,r.useState)(!1),[O,M]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{try{const e=await n.Z.get("https://cbitmis-backend-3.onrender.com/api/departments/blocks");t(e.data)}catch(e){console.error("Error fetching blocks:",e)}})()}),[]);return(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"10px"},children:[(0,y.jsx)("button",{onClick:()=>{if(!T)return;const e=Object.keys(T[0]),t=T.map((t=>{const a={};return e.forEach((e=>{a[e]=t[e]})),a})),a=m.P6.json_to_sheet(t),r=m.P6.book_new();m.P6.book_append_sheet(r,a,"posts"),m.NC(r,"postsData.xlsx"),V(!0)},style:{marginRight:"10px"},children:"Generate Excel"}),(0,y.jsx)("button",{onClick:()=>{if(!T)return;const e=new g.jsPDF;e.autoTable({html:"#jsonTable"}),e.save("jsonData.pdf"),M(!0)},children:"Generate PDF"})]}),(0,y.jsxs)(o.Z,{value:a,onChange:async e=>{const t=e.target.value;b(t);try{const e=await n.Z.get(`https://cbitmis-backend-3.onrender.com/api/departments/departments/${t}`);j(e.data)}catch(a){console.error(`Error fetching departments for block ${t}:`,a)}v(""),w([]),C(""),S([])},displayEmpty:!0,variant:"outlined",style:{marginRight:"10px"},children:[(0,y.jsx)(i.Z,{value:"",disabled:!0,children:"Select Block"}),e.map((e=>(0,y.jsx)(i.Z,{value:e,children:e},e)))]}),(0,y.jsxs)(o.Z,{value:Z,onChange:async e=>{const t=e.target.value;v(t);try{const e=await n.Z.get(`http://localhost:5000/api/departments/categories/${a}/${t}`);w(e.data)}catch(r){console.error(`Error fetching categories for department ${t} in block ${a}:`,r)}C(""),S([])},displayEmpty:!0,variant:"outlined",style:{marginRight:"10px"},disabled:!a,children:[(0,y.jsx)(i.Z,{value:"",disabled:!0,children:"Select Department"}),f.map((e=>(0,y.jsx)(i.Z,{value:e.name,children:e.name},e._id)))]}),(0,y.jsxs)(o.Z,{value:$,onChange:async e=>{const t=e.target.value;C(t);const r=`http://localhost:5000/api/departments/A/civil/${t}`;try{const e=await n.Z.get(r);S(e.data),(e=>{fetch(e).then((e=>{if(!e.ok)throw new Error("Failed to fetch data");return e.json()})).then((e=>{if(!(e&&e.length>0))throw new Error("Empty JSON response");L(e)})).catch((e=>{console.error("Error fetching data:",e)}))})(r)}catch(o){console.error(`Error fetching ${t} for department ${Z} in block ${a}:`,o)}},displayEmpty:!0,variant:"outlined",style:{marginRight:"10px"},disabled:!Z,children:[(0,y.jsx)(i.Z,{value:"",disabled:!0,children:"Select Category"}),k.map((e=>(0,y.jsx)(i.Z,{value:e,children:e},e)))]}),(0,y.jsxs)(s.Z,{sx:{width:"100%",overflow:"hidden"},children:[(0,y.jsx)(l.Z,{sx:{maxHeight:440},children:(0,y.jsxs)(c.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,y.jsx)(d.Z,{children:(0,y.jsx)(h.Z,{children:P.length>0&&"object"===typeof P[0]&&Object.keys(P[0]).map((e=>"_id"!==e&&(0,y.jsx)(u.Z,{children:(0,y.jsx)("b",{children:e.toUpperCase()})},e)))})}),(0,y.jsx)(p.Z,{children:P.map(((e,t)=>(0,y.jsx)(h.Z,{children:"object"===typeof e&&Object.keys(e).map((t=>"_id"!==t&&(0,y.jsx)(u.Z,{children:"boolean"===typeof e[t]?e[t]?"Yes":"No":e[t]},t)))},t)))})]})}),(0,y.jsx)(x.Z,{rowsPerPageOptions:[10,25,100],component:"div",count:P.length,rowsPerPage:R,page:_,onPageChange:(e,t)=>{E(t)},onRowsPerPageChange:e=>{F(+e.target.value),E(0)}})]}),D&&(0,y.jsx)("p",{children:"Excel file generated successfully."}),O&&(0,y.jsx)("p",{children:"PDF file generated successfully."})]})}},9726:function(e,t,a){a.d(t,{Z:function(){return d}});var r=a(9860),n=a(7503),o=a(5272),i=a(891),s=a(8119),l=a(6417);var c=e=>{let{color:t,outline:a,size:n,sx:o,...i}=e;const c=(0,r.Z)(),d=t&&!a&&{color:c.palette.background.paper,bgcolor:`${t}.main`},p=a&&{color:t?`${t}.main`:"primary.main",bgcolor:c.palette.background.paper,border:"2px solid",borderColor:t?`${t}.main`:"primary.main"};let h={};switch(n){case"badge":h={width:c.spacing(3.5),height:c.spacing(3.5)};break;case"xs":h={width:c.spacing(4.25),height:c.spacing(4.25)};break;case"sm":h={width:c.spacing(5),height:c.spacing(5)};break;case"lg":h={width:c.spacing(9),height:c.spacing(9)};break;case"xl":h={width:c.spacing(10.25),height:c.spacing(10.25)};break;case"md":h={width:c.spacing(7.5),height:c.spacing(7.5)};break;default:h={}}return(0,l.jsx)(s.Z,{sx:{...d,...p,...h,...o},...i})};var d=e=>{let{title:t,link:a,icon:s}=e;const d=(0,r.Z)();return(0,l.jsx)(n.Z,{title:t||"Reference",placement:"left",children:(0,l.jsxs)(o.Z,{disableRipple:!0,children:[!s&&(0,l.jsx)(c,{component:i.Z,href:a,target:"_blank",alt:"MUI Logo",size:"badge",color:"primary",outline:!0,children:(0,l.jsxs)("svg",{width:"500",height:"500",viewBox:"0 0 500 500",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsxs)("g",{clipPath:"url(#clip0)",children:[(0,l.jsx)("path",{d:"M100 260.9V131L212.5 195.95V239.25L137.5 195.95V282.55L100 260.9Z",fill:d.palette.primary[800]}),(0,l.jsx)("path",{d:"M212.5 195.95L325 131V260.9L250 304.2L212.5 282.55L287.5 239.25V195.95L212.5 239.25V195.95Z",fill:d.palette.primary.main}),(0,l.jsx)("path",{d:"M212.5 282.55V325.85L287.5 369.15V325.85L212.5 282.55Z",fill:d.palette.primary[800]}),(0,l.jsx)("path",{d:"M287.5 369.15L400 304.2V217.6L362.5 239.25V282.55L287.5 325.85V369.15ZM362.5 195.95V152.65L400 131V174.3L362.5 195.95Z",fill:d.palette.primary.main})]}),(0,l.jsx)("defs",{children:(0,l.jsx)("clipPath",{id:"clip0",children:(0,l.jsx)("rect",{width:"300",height:"238.3",fill:"white",transform:"translate(100 131)"})})})]})}),s&&(0,l.jsx)(c,{component:i.Z,href:a,target:"_blank",size:"badge",color:"primary",outline:!0,children:s})]})})}},3497:function(e,t,a){var r=a(7313),n=a(9860),o=a(3428),i=a(4641),s=a(1113),l=a(9536),c=a(3405),d=a(6417);const p={"& .MuiCardHeader-action":{mr:0}},h=(0,r.forwardRef)(((e,t)=>{let{border:a=!0,boxShadow:r,children:h,content:u=!0,contentClass:x="",contentSX:m={},darkTitle:g,secondary:y,shadow:b,sx:f={},title:j,...Z}=e;const v=(0,n.Z)();return(0,d.jsxs)(o.Z,{ref:t,...Z,sx:{border:a?"1px solid":"none",borderColor:v.palette.primary[200]+25,":hover":{boxShadow:r?b||"0 2px 14px 0 rgb(32 40 45 / 8%)":"inherit"},...f},children:[j&&(0,d.jsx)(i.Z,{sx:p,title:g?(0,d.jsx)(s.Z,{variant:"h3",children:j}):j,action:y}),j&&(0,d.jsx)(l.Z,{}),u&&(0,d.jsx)(c.Z,{sx:m,className:x,children:h}),!u&&h]})}));t.Z=h},5229:function(e,t,a){a.d(t,{Z:function(){return A}});var r=a(7313),n=a(5662),o=a(501),i=a(1629),s=a(6835),l=a(3477),c=a(3467),d=a(4076),p=a(7478),h=a(7649),u=a(1095),x=a(8737),m=a(5508),g=(a(8695),a(1405)),y=a(2548),b=a(7462),f=a(3366),j=a(4146),Z=a(1921),v=a(8334),k=a(7592),w=a(7342),$=a(2461),C=a(7482),P=a(7843),S=a(3306),_=a(1550),E=a(5480),R=a(7430),F=a(2298);function T(e){return(0,F.ZP)("MuiTextField",e)}(0,R.Z)("MuiTextField",["root"]);var L=a(6417);const D=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],V={standard:$.Z,filled:C.Z,outlined:P.Z},O=(0,k.ZP)(_.Z,{name:"MuiTextField",slot:"Root",overridesResolver:(e,t)=>t.root})({});var M=r.forwardRef((function(e,t){const a=(0,w.Z)({props:e,name:"MuiTextField"}),{autoComplete:r,autoFocus:n=!1,children:o,className:i,color:s="primary",defaultValue:l,disabled:c=!1,error:d=!1,FormHelperTextProps:p,fullWidth:h=!1,helperText:u,id:x,InputLabelProps:m,inputProps:g,InputProps:k,inputRef:$,label:C,maxRows:P,minRows:_,multiline:R=!1,name:F,onBlur:M,onChange:N,onFocus:B,placeholder:A,required:I=!1,rows:H,select:W=!1,SelectProps:U,type:q,value:z,variant:G="outlined"}=a,Y=(0,f.Z)(a,D),J=(0,b.Z)({},a,{autoFocus:n,color:s,disabled:c,error:d,fullWidth:h,multiline:R,required:I,select:W,variant:G}),X=(e=>{const{classes:t}=e;return(0,Z.Z)({root:["root"]},T,t)})(J);const K={};"outlined"===G&&(m&&"undefined"!==typeof m.shrink&&(K.notched=m.shrink),K.label=C),W&&(U&&U.native||(K.id=void 0),K["aria-describedby"]=void 0);const Q=(0,v.Z)(x),ee=u&&Q?`${Q}-helper-text`:void 0,te=C&&Q?`${Q}-label`:void 0,ae=V[G],re=(0,L.jsx)(ae,(0,b.Z)({"aria-describedby":ee,autoComplete:r,autoFocus:n,defaultValue:l,fullWidth:h,multiline:R,name:F,rows:H,maxRows:P,minRows:_,type:q,value:z,id:Q,inputRef:$,onBlur:M,onChange:N,onFocus:B,placeholder:A,inputProps:g},K,k));return(0,L.jsxs)(O,(0,b.Z)({className:(0,j.Z)(X.root,i),disabled:c,error:d,fullWidth:h,ref:t,required:I,color:s,variant:G,ownerState:J},Y,{children:[null!=C&&""!==C&&(0,L.jsx)(S.Z,(0,b.Z)({htmlFor:Q,id:te},m,{children:C})),W?(0,L.jsx)(y.Z,(0,b.Z)({"aria-describedby":ee,id:Q,labelId:te,value:z,input:re},U,{children:o})):re,u&&(0,L.jsx)(E.Z,(0,b.Z)({id:ee},p,{children:u}))]}))})),N=a(5281),B=a(4953);var A=e=>{let{block:t,department:a}=e;const[b,f]=(0,r.useState)([]),[j,Z]=(0,r.useState)("Labs"),[v,k]=(0,r.useState)([]),[w,$]=(0,r.useState)(null),[C,P]=(0,r.useState)({}),[S,_]=(0,r.useState)(0),[E,R]=(0,r.useState)(10),[F,T]=(0,r.useState)(!1),[D,V]=(0,r.useState)(!1),[O,A]=(0,r.useState)(null),[I,H]=(0,r.useState)(null);(0,r.useEffect)((()=>{(async()=>{try{const e=await n.Z.get(`https://miscbit-10.onrender.com/api/block/categories/${t}/${a}`);f(e.data)}catch(I){console.error(`Error fetching categories for department ${a} in block ${t}:`,I)}})()}),[t,a]),(0,r.useEffect)((()=>{"All Data"!==j&&U()}),[j,t,a]),(0,r.useEffect)((()=>{Array.isArray(v)||k([])}),[v]);const W=()=>{k((e=>e.map((e=>e._id===w?C:e)))),$(null)},U=async()=>{V(!0);const e=`https://miscbit-10.onrender.com/api/block/category/data/${t}/${a}/${j}`;try{const t=await n.Z.get(e);t.data&&"object"===typeof t.data?k(t.data[j]||[]):k([])}catch(I){console.error(`Error fetching data for category ${j} in department ${a} in block ${t}:`,I),k([])}finally{V(!1)}};return(0,L.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"20px"},children:[(0,L.jsx)("div",{style:{marginBottom:"20px",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"center"},children:(0,L.jsxs)(y.Z,{value:j,onChange:e=>(async e=>{V(!0),Z(e);const r="All Data"===e?`https://miscbit-10.onrender.com/api/block/department/data/${t}/${a}`:`https://miscbit-10.onrender.com/api/block/category/data/${t}/${a}/${e}`;try{const t=await n.Z.get(r);t.data&&"object"===typeof t.data?k(t.data[e]||[]):k([])}catch(I){console.error(`Error fetching data for category ${e} in department ${a} in block ${t}:`,I),k([])}finally{V(!1)}})(e.target.value),style:{width:"100%",marginBottom:"10px",borderRadius:"4px"},displayEmpty:!0,inputProps:{"aria-label":"Select category"},children:[(0,L.jsx)(g.Z,{value:"",disabled:!0,children:"Select a category"}),b.map((e=>"Student"!==e&&"Faculty"!==e&&"Faculty"!==e&&"Research"!==e&&"Timetables"!==e&&"Committe"!==e&&"EventsOrganized"!==e&&"EventsParticipated"!==e&&"Clubs"!==e&&"Mentoring"!==e&&(0,L.jsx)(g.Z,{value:e,children:e},e)))]})}),(0,L.jsxs)(o.Z,{style:{width:"100%",overflow:"hidden",marginTop:"20px"},children:[(0,L.jsx)(i.Z,{style:{maxHeight:"440px",overflowY:"auto"},children:(0,L.jsxs)(s.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,L.jsx)(l.Z,{children:(0,L.jsxs)(d.Z,{children:[v.length>0&&Object.keys(v[0]).map((e=>"_id"!==e&&(0,L.jsx)(p.Z,{children:(0,L.jsx)("strong",{children:e.toUpperCase()})},e))),(0,L.jsx)(p.Z,{children:(0,L.jsx)("strong",{children:"ACTIONS"})})]})}),(0,L.jsx)(c.Z,{children:D?(0,L.jsx)(d.Z,{children:(0,L.jsx)(p.Z,{colSpan:Object.keys(v[0]||{}).length+1,style:{textAlign:"center"},children:(0,L.jsx)(N.Z,{})})}):0===v.length?(0,L.jsx)(d.Z,{children:(0,L.jsx)(p.Z,{colSpan:Object.keys(v[0]||{}).length+1,style:{textAlign:"center"},children:"No data available"})}):v.slice(S*E,S*E+E).map((e=>(0,L.jsxs)(d.Z,{children:[Object.keys(e).map((t=>"_id"!==t&&(0,L.jsx)(p.Z,{children:w===e._id?(0,L.jsx)(M,{value:C[t],onChange:e=>{return a=e,r=t,P({...C,[r]:a.target.value}),void T(!0);var a,r},fullWidth:!0}):"boolean"===typeof e[t]?e[t]?"Yes":"No":e[t]},t))),(0,L.jsx)(p.Z,{children:w===e._id?(0,L.jsx)(u.Z,{onClick:W,variant:"contained",color:"secondary",children:"Save"}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(u.Z,{onClick:()=>(e=>{const t=v.find((t=>t._id===e));$(e),P({...t}),A({...t})})(e._id),variant:"contained",color:"primary",style:{marginRight:"10px",marginTop:"7px"},children:"Modify"}),(0,L.jsx)(u.Z,{onClick:()=>(async e=>{try{const r=await n.Z.delete(`https://miscbit-10.onrender.com/api/block/delete/${t}/${a}/${e}`);200===r.status?(console.log("Data deleted successfully"),k((t=>t.filter((t=>t._id!==e)))),T(!0)):console.error("Unexpected response:",r)}catch(I){console.error("Error deleting data:",I)}})(e._id),variant:"contained",color:"error",style:{marginRight:"10px",marginTop:"7px"},children:"Delete"})]})})]},e._id)))})]})}),(0,L.jsx)(h.Z,{style:{marginTop:"20px"},rowsPerPageOptions:[10,25,100],component:"div",count:v.length,rowsPerPage:E,page:S,onPageChange:(e,t)=>{_(t)},onRowsPerPageChange:e=>{R(+e.target.value),_(0)}})]}),(0,L.jsxs)("div",{style:{marginTop:"20px",display:"flex",justifyContent:"center"},className:"button-container",children:[(0,L.jsx)(u.Z,{onClick:()=>{const e=Object.keys(v[0]),a=v.map((t=>{const a={};return e.forEach((e=>{"_id"!==e&&(a[e]=t[e])})),a})),r=x.P6.json_to_sheet(a),n=x.P6.book_new();x.P6.book_append_sheet(n,r,`${j}`),x.NC(n,`${t}Block-${j}-Data.xlsx`)},style:{marginRight:"10px",marginBottom:"10px"},variant:"contained",color:"primary",children:"Generate Excel"}),(0,L.jsx)(u.Z,{onClick:()=>{const e=Object.keys(v[0]).filter((e=>"_id"!==e)),a=v.map((t=>e.map((e=>"boolean"===typeof t[e]?t[e]?"Yes":"No":t[e])))),r=new m.jsPDF;r.autoTable({head:[e],body:a}),r.save(`${t}Block-${j}-Data.pdf`)},style:{marginBottom:"10px"},variant:"contained",color:"primary",children:"Generate PDF"})]}),F&&(0,L.jsx)(u.Z,{variant:"contained",color:"primary",onClick:async()=>{if(!O)return void console.error("Old data is not defined");const e={oldData:O,newData:C,selectedCategory:j};try{console.log("Submitting changes..."),await n.Z.put(`https://miscbit-10.onrender.com/api/block/update/${t}/${a}`,e),console.log("Updated department data:",v),console.log("Data submitted successfully"),T(!1),alert("Changes submitted successfully!")}catch(I){console.error("Error submitting data:",I)}},style:{position:"fixed",bottom:"20px",right:"25px"},children:"Submit"}),I&&(0,L.jsx)(B.Z,{severity:"error",style:{marginTop:"20px"},children:I})]})}}}]);