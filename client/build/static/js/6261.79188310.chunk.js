"use strict";(self.webpackChunkcbit_management_information_system=self.webpackChunkcbit_management_information_system||[]).push([[6261],{6261:function(e,t,a){a.r(t);var n=a(7313),s=a(5662),r=a(2548),o=a(1405),c=a(501),l=a(1629),i=a(6835),d=a(3477),h=a(3467),p=a(4076),u=a(7478),g=a(7649),m=a(8737),x=a(5508),j=(a(8695),a(6417));t.default=()=>{const[e,t]=(0,n.useState)([]),[a,f]=(0,n.useState)(""),[y,b]=(0,n.useState)([]),[v,Z]=(0,n.useState)(""),[k,w]=(0,n.useState)([]),[S,E]=(0,n.useState)(""),[_,C]=(0,n.useState)([]),[P,$]=n.useState(0),[D,O]=n.useState(10),[R,F]=(0,n.useState)(null),[N,B]=(0,n.useState)(!1),[G,H]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(async()=>{try{const e=await s.Z.get("https://cbitmis-backend-3.onrender.com/api/departments/blocks");t(e.data)}catch(e){console.error("Error fetching blocks:",e)}})()}),[]);return(0,j.jsxs)("div",{children:[(0,j.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"10px"},children:[(0,j.jsx)("button",{onClick:()=>{if(!R)return;const e=Object.keys(R[0]),t=R.map((t=>{const a={};return e.forEach((e=>{a[e]=t[e]})),a})),a=m.P6.json_to_sheet(t),n=m.P6.book_new();m.P6.book_append_sheet(n,a,"posts"),m.NC(n,"postsData.xlsx"),B(!0)},style:{marginRight:"10px"},children:"Generate Excel"}),(0,j.jsx)("button",{onClick:()=>{if(!R)return;const e=new x.jsPDF;e.autoTable({html:"#jsonTable"}),e.save("jsonData.pdf"),H(!0)},children:"Generate PDF"})]}),(0,j.jsxs)(r.Z,{value:a,onChange:async e=>{const t=e.target.value;f(t);try{const e=await s.Z.get(`https://cbitmis-backend-3.onrender.com/api/departments/departments/${t}`);b(e.data)}catch(a){console.error(`Error fetching departments for block ${t}:`,a)}Z(""),w([]),E(""),C([])},displayEmpty:!0,variant:"outlined",style:{marginRight:"10px"},children:[(0,j.jsx)(o.Z,{value:"",disabled:!0,children:"Select Block"}),e.map((e=>(0,j.jsx)(o.Z,{value:e,children:e},e)))]}),(0,j.jsxs)(r.Z,{value:v,onChange:async e=>{const t=e.target.value;Z(t);try{const e=await s.Z.get(`http://localhost:5000/api/departments/categories/${a}/${t}`);w(e.data)}catch(n){console.error(`Error fetching categories for department ${t} in block ${a}:`,n)}E(""),C([])},displayEmpty:!0,variant:"outlined",style:{marginRight:"10px"},disabled:!a,children:[(0,j.jsx)(o.Z,{value:"",disabled:!0,children:"Select Department"}),y.map((e=>(0,j.jsx)(o.Z,{value:e.name,children:e.name},e._id)))]}),(0,j.jsxs)(r.Z,{value:S,onChange:async e=>{const t=e.target.value;E(t);const n=`http://localhost:5000/api/departments/A/civil/${t}`;try{const e=await s.Z.get(n);C(e.data),(e=>{fetch(e).then((e=>{if(!e.ok)throw new Error("Failed to fetch data");return e.json()})).then((e=>{if(!(e&&e.length>0))throw new Error("Empty JSON response");F(e)})).catch((e=>{console.error("Error fetching data:",e)}))})(n)}catch(r){console.error(`Error fetching ${t} for department ${v} in block ${a}:`,r)}},displayEmpty:!0,variant:"outlined",style:{marginRight:"10px"},disabled:!v,children:[(0,j.jsx)(o.Z,{value:"",disabled:!0,children:"Select Category"}),k.map((e=>(0,j.jsx)(o.Z,{value:e,children:e},e)))]}),(0,j.jsxs)(c.Z,{sx:{width:"100%",overflow:"hidden"},children:[(0,j.jsx)(l.Z,{sx:{maxHeight:440},children:(0,j.jsxs)(i.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,j.jsx)(d.Z,{children:(0,j.jsx)(p.Z,{children:_.length>0&&"object"===typeof _[0]&&Object.keys(_[0]).map((e=>"_id"!==e&&(0,j.jsx)(u.Z,{children:(0,j.jsx)("b",{children:e.toUpperCase()})},e)))})}),(0,j.jsx)(h.Z,{children:_.map(((e,t)=>(0,j.jsx)(p.Z,{children:"object"===typeof e&&Object.keys(e).map((t=>"_id"!==t&&(0,j.jsx)(u.Z,{children:"boolean"===typeof e[t]?e[t]?"Yes":"No":e[t]},t)))},t)))})]})}),(0,j.jsx)(g.Z,{rowsPerPageOptions:[10,25,100],component:"div",count:_.length,rowsPerPage:D,page:P,onPageChange:(e,t)=>{$(t)},onRowsPerPageChange:e=>{O(+e.target.value),$(0)}})]}),N&&(0,j.jsx)("p",{children:"Excel file generated successfully."}),G&&(0,j.jsx)("p",{children:"PDF file generated successfully."})]})}}}]);